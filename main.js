(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._settings=e,this._formElement=t}var r,o;return r=n,(o=[{key:"_showInputError",value:function(e,t){var n=this._settings,r=n.inputErrorClass,o=n.errorClass,i=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(r),i.textContent=t,i.classList.add(o)}},{key:"_hideInputError",value:function(e){var t=this._settings,n=t.inputErrorClass,r=t.errorClass,o=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(n),o.textContent="",o.classList.remove(r)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_setEventListeners",value:function(){var t,n=this,r=this._settings.inputSelector;this.inputElements=function(t){if(Array.isArray(t))return e(t)}(t=this._formElement.querySelectorAll(r))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),this.inputElements.forEach((function(e){e.addEventListener("input",(function(t){n._checkInputValidity(e),n._toggleButtonState()}))}))}},{key:"_isAllInputsValid",value:function(){return this.inputElements.every((function(e){return!0===e.validity.valid}))}},{key:"_toggleButtonState",value:function(){var e=this._settings,t=e.inactiveButtonClass,n=e.submitButtonSelector,r=this._formElement.querySelector(n);this._isAllInputsValid()?(r.disabled=!1,r.classList.remove(t)):(r.disabled=!0,r.classList.add(t))}},{key:"resetValidation",value:function(){var e=this;this.inputElements.forEach((function(t){e._hideInputError(t)})),this._toggleButtonState()}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&t(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),n}();const r=n;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(t,n,r){var o=this,a=t.name,c=t.link;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"_handleLikeIcon",(function(e){return e.target.classList.toggle("card__like-button_active")})),i(this,"_handleDeleteCard",(function(){o._cardElement.remove(),o._cardElement=null})),i(this,"getCardElement",(function(){o._cardElement=o._cardTemplate.cloneNode(!0);var e=o._cardElement.querySelector(".card__title"),t=o._cardElement.querySelector(".card__image");return e.textContent=o._name,t.style.backgroundImage="url(".concat(o._link,")"),o._setEventListeners(),this_likes.length,o._cardElement.querySelector("card__likes").textContent,o._cardElement})),this._name=a,this._link=c,this._likes=data.likes,this._cardTemplate=document.querySelector(n).content.querySelector(".card"),this._handleCardClick=r}var t,n;return t=e,(n=[{key:"_setEventListeners",value:function(){var e=this,t=this._cardElement.querySelector(".card__like-button"),n=this._cardElement.querySelector(".card__delete-button"),r=this._cardElement.querySelector(".card__image");t.addEventListener("click",this._handleLikeIcon),n.addEventListener("click",this._handleDeleteCard),r.addEventListener("click",(function(){return e._handleCardClick(e._link,e._name)}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"open",value:function(){this._popupElement.classList.add("popup_open"),document.addEventListener("keyup",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_open"),document.removeEventListener("keyup",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__close-button"))&&e.close()}))}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p.apply(this,arguments)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function h(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(r);if(o){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._handleSubmit=t,n._formElement=n._popupElement.querySelector(".popup__form"),n}return t=a,(n=[{key:"_getInputValues",value:function(){var e,t={};return(e=this._formElement.querySelectorAll(".popup__form-input"),function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach((function(e){var n=e.name,r=e.value;t[n]=r})),t}},{key:"setEventListeners",value:function(){var e=this;p(_(a.prototype),"setEventListeners",this).call(this),this._formElement.addEventListener("submit",(function(t){t.preventDefault();var n=e._getInputValues();e._handleSubmit(n)}))}},{key:"close",value:function(){p(_(a.prototype),"close",this).call(this),this._formElement.reset()}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(u);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=w(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function w(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function S(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(r);if(o){var n=j(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function a(){return v(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"open",value:function(e,t){g(j(a.prototype),"open",this).call(this);var n=this._popupElement.querySelector(".popup__preview-image"),r=this._popupElement.querySelector(".popup__preview-caption");n.src=e,r.textContent=t}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(u);function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(t,n){var r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderer=r,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(t){var n=t.profileNameSelector,r=t.profileJobSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._profileName=document.querySelector(n),this._profileJob=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}},{key:"setUserInfo",value:function(e,t){this._profileName.textContent=e,this._profileJob.textContent=t}}])&&L(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),q={inputSelector:".popup__form-input",submitButtonSelector:".popup__form-button",inactiveButtonClass:"popup__form-button_disabled",inputErrorClass:"popup__form-input_type_error",errorClass:"popup__form-error_visible"},T=document.querySelector(".popup_type_edit-profile"),A=document.querySelector(".popup_type_add-card"),R=T.querySelector(".popup__form_type_edit"),x=document.querySelector(".profile__add-button"),U=A.querySelector(".popup__form_type_add-card"),V=document.querySelector(".profile__edit-button"),B=document.querySelector(".popup__form-input_type_name"),D=document.querySelector(".popup__form-input_type_job");function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}document.querySelector(".cards__gallery");var J=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return fetch(this._baseUrl+"/users/me/",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)}))}},{key:"getCards",value:function(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)}))}},{key:"editProfile",value:function(e,t){return(fetch(this._baseUrl+"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)}))}},{key:"addCard",value:function(e,t){return(fetch(this._baseUrl+"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)}))}}])&&N(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"c38a1131-295f-471c-b53b-3cfda4699ea7","Content-Type":"application/json"}});J.getUserInfo().then((function(e){Q.setUserInfo(e.name,e.job)})).catch(console.log),J.getCards().then((function(e){console.log("res => ",e),H.renderItems(e)})).catch(console.log);var M=new r(q,R),$=new r(q,U);M.enableValidation(),$.enableValidation();var z=function(e){var t=new a(e,"#card-template",(function(e,t){K.open(e,t)})).getCardElement();H.addItem(t)},H=new P({renderer:z},".cards__gallery"),F=new b(".popup_type_add-card",(function(e){J.addCard(e.card__title,e.link).then((function(e){z({name:e.name,link:e.link})})).catch(console.log),F.close()}));F.setEventListeners();var G=new b(".popup_type_edit-profile",(function(e){J.editProfile(e.name,e.job).then((function(t){Q.setUserInfo(e.name,e.job)})).catch(console.log).finally((function(){G.close()}))}));G.setEventListeners();var K=new O(".popup_type_preview");K.setEventListeners();var Q=new I({profileNameSelector:".profile__title",profileJobSelector:".profile__subtitle"});V.addEventListener("click",(function(){var e=Q.getUserInfo();B.value=e.name,D.value=e.job,M.resetValidation(),G.open()})),x.addEventListener("click",(function(){$.resetValidation(),F.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SixJQWFEOEUsRUFBeUJELG9CQUd6QixJQUFNTCxFQUFhLElBQUk1RCxFQUFlLHVCQUN0QzRELEVBQVdLLG9CQUdYLElBQU1sQixFQUFXLElBQUluQyxFQUFTLENBQzVCQyxvQkFBcUIsa0JBQ3JCQyxtQkFBb0IsdUJBSXRCUyxFQUFzQm5GLGlCQUFpQixTQUFTLFdBQzlDLElBQU1nSSxFQUFjckIsRUFBU3NCLGNBQzdCN0MsRUFBZTVCLE1BQVF3RSxFQUFZaEgsS0FDbkNxRSxFQUFjN0IsTUFBUXdFLEVBQVluRCxJQUNsQ3FDLEVBQXlCZ0Isa0JBQ3pCSixFQUF5QkwsTUFDMUIsSUFDRHhDLEVBQWtCakYsaUJBQWlCLFNBQVMsV0FDMUNtSCxFQUFxQmUsa0JBQ3JCTixFQUFxQkgsTUFDdEIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIHRoaXMuaW5wdXRFbGVtZW50cyA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGlucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaXNBbGxJbnB1dHNWYWxpZCgpIHtcclxuICAgIHJldHVybiB0aGlzLmlucHV0RWxlbWVudHMuZXZlcnkoXHJcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCA9PT0gdHJ1ZVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcywgc3VibWl0QnV0dG9uU2VsZWN0b3IgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIGlmICh0aGlzLl9pc0FsbElucHV0c1ZhbGlkKCkpIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsIi8vQ3JlYXRlcyBhIENhcmQgd2l0aCBUZXh0IGFuZCBhbiBJbWFnZSBMaW5rXHJcblxyXG5leHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rIH0sIHRlbXBsYXRlQ2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2spIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0ZW1wbGF0ZUNhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gIH1cclxuXHJcbiAgLy9Qcml2YXRlIE1ldGhvZCBmb3IgQWRkaW5nIEV2ZW50IExpc3RlbmVyc1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBjb25zdCBsaWtlQ2FyZEJ1dHRvbiA9XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICBjb25zdCBkZWxldGVDYXJkQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGxpa2VDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlSWNvbik7XHJcbiAgICBkZWxldGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKTtcclxuICAgIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX2xpbmssIHRoaXMuX25hbWUpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy9Qcml2YXRlIE1ldGhvZHMgZm9yIEVhY2ggT25lIG9mIHRoZSBIYW5kbGVyc1xyXG5cclxuICBfaGFuZGxlTGlrZUljb24gPSAoZXZ0KSA9PlxyXG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG5cclxuICBfaGFuZGxlRGVsZXRlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIC8vUmV0dXJucyBhIEZ1bGx5IEZ1bmN0aW9uYWwgQ2FyZCBFbGVtZW50IFBvcHVsYXRlZCB3aXRoIERhdGFcclxuXHJcbiAgZ2V0Q2FyZEVsZW1lbnQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIGNhcmRJbWFnZS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dGhpcy5fbGlua30pYDtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIGNvbnN0IGxpa2VzQW1vdW50ID0gdGhpc19saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcImNhcmRfX2xpa2VzXCIpLnRleHRDb250ZW50O1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9O1xyXG59XHJcbiIsImNvbnN0IFBPUFVQX0NMQVNTID0gXCJwb3B1cFwiO1xyXG5jb25zdCBDTE9TRV9CVVRUT05fQ0xBU1MgPSBcInBvcHVwX19jbG9zZS1idXR0b25cIjtcclxuXHJcbmNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhQT1BVUF9DTEFTUykgfHxcclxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKENMT1NFX0JVVFRPTl9DTEFTUylcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IFBvcHVwIH07XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgdmFsdWVzID0ge307XHJcblxyXG4gICAgY29uc3QgaW5wdXRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19mb3JtLWlucHV0XCIpLFxyXG4gICAgXTtcclxuXHJcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgY29uc3Qga2V5ID0gaW5wdXQubmFtZTtcclxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuXHJcbiAgICAgIHZhbHVlc1trZXldID0gdmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpOyAvL3N1cGVyIGFsbG93cyB0byBzYXZlIHRoZSBwYXJlbnQgY2xhc3MgZnVuY3Rpb25hbGl0eSBhbmQgdG8gZXh0ZW5kIGl0IHRvIGFkZGl0aW9uYWwgZnVuY3Rpb25hbGl0eVxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgdmFsdWVzRnJvbUZvcm0gPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodmFsdWVzRnJvbUZvcm0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgLy8gY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gIC8vICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKVxyXG4gIC8vIH1cclxuICAvL1xyXG4gIG9wZW4obGluaywgbmFtZSkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgY29uc3QgaW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcHJldmlldy1pbWFnZVwiKTtcclxuICAgIGNvbnN0IGNhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcHJldmlldy1jYXB0aW9uXCIpO1xyXG5cclxuICAgIGltYWdlLnNyYyA9IGxpbms7XHJcbiAgICBjYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICBpdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGRhdGEpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcHJvZmlsZU5hbWVTZWxlY3RvciwgcHJvZmlsZUpvYlNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVKb2JTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IG5hbWUgPSB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICAgIGNvbnN0IGpvYiA9IHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQ7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lLFxyXG4gICAgICBqb2IsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0taW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0tYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fZm9ybS1idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2Zvcm0taW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Zvcm0tZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuLy9Nb2RhbHNcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiKTtcclxuXHJcbi8vRm9ybXNcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGVkaXRQcm9maWxlUG9wdXAucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9fZm9ybV90eXBlX2VkaXRcIlxyXG4pO1xyXG5leHBvcnQgY29uc3Qgb3BlbkFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGFkZENhcmRQb3B1cC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnBvcHVwX19mb3JtX3R5cGVfYWRkLWNhcmRcIlxyXG4pO1xyXG5cclxuLy9EZWNsYXJhdGlvbnNcclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG4vL0J1dHRvbnMgYW5kIE90aGVyIERPTSBFbGVtZW50c1xyXG5leHBvcnQgY29uc3Qgb3BlbkVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXHJcbik7XHJcblxyXG4vL0lucHV0c1xyXG5leHBvcnQgY29uc3QgaW5wdXROYW1lVmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnBvcHVwX19mb3JtLWlucHV0X3R5cGVfbmFtZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBpbnB1dEpvYlZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9fZm9ybS1pbnB1dF90eXBlX2pvYlwiXHJcbik7XHJcblxyXG4vL1RlbXBsYXRlc1xyXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XHJcblxyXG4vL1dyYXBwZXJzXHJcbmV4cG9ydCBjb25zdCBjYXJkc0dhbGxlcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19nYWxsZXJ5XCIpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lL1wiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IChyZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKSk7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiAocmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSkpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFByb2ZpbGUobmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiAoZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lXCIpLFxyXG4gICAge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiAocmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSkpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gKGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiKSxcclxuICAgIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IChyZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJjMzhhMTEzMS0yOTVmLTQ3MWMtYjUzYi0zY2ZkYTQ2OTllYTdcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIHNldHRpbmdzLFxyXG4gIGVkaXRQcm9maWxlRm9ybSxcclxuICBvcGVuQWRkQ2FyZEJ1dHRvbixcclxuICBhZGRDYXJkRm9ybSxcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgb3BlbkVkaXRQcm9maWxlQnV0dG9uLFxyXG4gIGlucHV0TmFtZVZhbHVlLFxyXG4gIGlucHV0Sm9iVmFsdWUsXHJcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi8uLi91dGlscy9BcGlcIjtcclxuXHJcbmFwaVxyXG4gIC5nZXRVc2VySW5mbygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5qb2IpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRDYXJkcygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCJyZXMgPT4gXCIsIHJlcyk7XHJcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKHJlcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5sb2cpO1xyXG5cclxuLy9Gb3JtIFZhbGlkYXRvciBJbnN0YW5jZXNcclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGVkaXRQcm9maWxlRm9ybSk7XHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGFkZENhcmRGb3JtKTtcclxuXHJcbmVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IHJlbmRlckNhcmQgPSAoY2FyZERhdGEpID0+IHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKGNhcmREYXRhLCBjYXJkVGVtcGxhdGVTZWxlY3RvciwgKGxpbmssIG5hbWUpID0+IHtcclxuICAgIGltYWdlUG9wdXAub3BlbihsaW5rLCBuYW1lKTtcclxuICB9KTtcclxuICBjb25zdCBuZXdDYXJkRWxlbWVudCA9IGNhcmRFbGVtZW50LmdldENhcmRFbGVtZW50KCk7XHJcbiAgc2VjdGlvbi5hZGRJdGVtKG5ld0NhcmRFbGVtZW50KTtcclxufTtcclxuXHJcbi8vU2VjdGlvbiBDbGFzcyBJbnN0YW5jZVxyXG5cclxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKHsgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSwgXCIuY2FyZHNfX2dhbGxlcnlcIik7XHJcblxyXG4vL0Z1bmN0aW9uc1xyXG5cclxuY29uc3QgaGFuZGxlQWRkQ2FyZFN1Ym1pdCA9IChkYXRhKSA9PiB7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZChkYXRhW1wiY2FyZF9fdGl0bGVcIl0sIGRhdGEubGluaylcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmVuZGVyQ2FyZCh7IG5hbWU6IHJlcy5uYW1lLCBsaW5rOiByZXMubGluayB9LCBpbml0aWFsQ2FyZHMpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmxvZyk7XHJcbiAgYWRkQ2FyZFBvcHVwV2l0aEZvcm0uY2xvc2UoKTtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUVkaXRQcm9maWxlU3VibWl0ID0gKGRhdGEpID0+IHtcclxuICBhcGlcclxuICAgIC5lZGl0UHJvZmlsZShkYXRhLm5hbWUsIGRhdGEuam9iKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhLm5hbWUsIGRhdGEuam9iKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRQcm9maWxlUG9wdXBXaXRoRm9ybS5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG4vL1BvcHVwV2l0aEZvcm0gQ2xhc3MgSW5zdGFuY2VzXHJcbmNvbnN0IGFkZENhcmRQb3B1cFdpdGhGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiLFxyXG4gIGhhbmRsZUFkZENhcmRTdWJtaXRcclxuKTtcclxuYWRkQ2FyZFBvcHVwV2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXBXaXRoRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsXHJcbiAgaGFuZGxlRWRpdFByb2ZpbGVTdWJtaXRcclxuKTtcclxuZWRpdFByb2ZpbGVQb3B1cFdpdGhGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL1BvcHVwV2l0aEltYWdlIENsYXNzIEluc3RhbmNlXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZV9wcmV2aWV3XCIpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL1VzZXJJbmZvIENsYXNzIEluc3RhbmNlXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBwcm9maWxlTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIHByb2ZpbGVKb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxufSk7XHJcblxyXG4vL0V2ZW50IEhhbmRsZXJzXHJcbm9wZW5FZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHByb2ZpbGVEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBpbnB1dE5hbWVWYWx1ZS52YWx1ZSA9IHByb2ZpbGVEYXRhLm5hbWU7XHJcbiAgaW5wdXRKb2JWYWx1ZS52YWx1ZSA9IHByb2ZpbGVEYXRhLmpvYjtcclxuICBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdFByb2ZpbGVQb3B1cFdpdGhGb3JtLm9wZW4oKTtcclxufSk7XHJcbm9wZW5BZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYWRkQ2FyZFBvcHVwV2l0aEZvcm0ub3BlbigpO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInJlbW92ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImlucHV0U2VsZWN0b3IiLCJpbnB1dEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJldmVyeSIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImJ1dHRvbkVsZW1lbnQiLCJfaXNBbGxJbnB1dHNWYWxpZCIsImRpc2FibGVkIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJDYXJkIiwidGVtcGxhdGVDYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJuYW1lIiwibGluayIsInRhcmdldCIsInRvZ2dsZSIsIl9jYXJkRWxlbWVudCIsIl9jYXJkVGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJjYXJkVGl0bGUiLCJjYXJkSW1hZ2UiLCJfbmFtZSIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiX2xpbmsiLCJ0aGlzX2xpa2VzIiwibGVuZ3RoIiwiX2xpa2VzIiwiZGF0YSIsImxpa2VzIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiX2hhbmRsZUNhcmRDbGljayIsImxpa2VDYXJkQnV0dG9uIiwiZGVsZXRlQ2FyZEJ1dHRvbiIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJldmVudCIsImtleSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdCIsIl9oYW5kbGVTdWJtaXQiLCJ2YWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwidmFsdWVzRnJvbUZvcm0iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIlBvcHVwV2l0aEltYWdlIiwiaW1hZ2UiLCJjYXB0aW9uIiwic3JjIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbXMiLCJlbGVtZW50IiwicHJlcGVuZCIsIlVzZXJJbmZvIiwicHJvZmlsZU5hbWVTZWxlY3RvciIsInByb2ZpbGVKb2JTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiam9iIiwiZWRpdFByb2ZpbGVQb3B1cCIsImFkZENhcmRQb3B1cCIsImVkaXRQcm9maWxlRm9ybSIsIm9wZW5BZGRDYXJkQnV0dG9uIiwiYWRkQ2FyZEZvcm0iLCJvcGVuRWRpdFByb2ZpbGVCdXR0b24iLCJpbnB1dE5hbWVWYWx1ZSIsImlucHV0Sm9iVmFsdWUiLCJhcGkiLCJBcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJzZWN0aW9uIiwicmVuZGVySXRlbXMiLCJlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsImVuYWJsZVZhbGlkYXRpb24iLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJuZXdDYXJkRWxlbWVudCIsImltYWdlUG9wdXAiLCJvcGVuIiwiZ2V0Q2FyZEVsZW1lbnQiLCJhZGRJdGVtIiwiYWRkQ2FyZFBvcHVwV2l0aEZvcm0iLCJzZXRFdmVudExpc3RlbmVycyIsImVkaXRQcm9maWxlUG9wdXBXaXRoRm9ybSIsImZpbmFsbHkiLCJwcm9maWxlRGF0YSIsImdldFVzZXJJbmZvIiwicmVzZXRWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==